--1. top 10 categories
select 
    p.category_name, 
    sum(f.spend_amount_usd) as total_spend
from fact_sales f
join dim_product p on f.dim_productid = p.dim_productid
where p.category_name is not null 
  and p.category_name not in ('Unknown', 'n/a', 'Other') 
group by p.category_name
order by total_spend desc 
limit 10;

--2.daily sales
select 
    d.date, 
    sum(f.spend_amount_usd) as daily_spend
from fact_sales f
join dim_date d on f.dim_dateid = d.dim_dateid
group by d.date
order by d.date;

--3.transaction value/item count
select 
    f.item_count, 
    f.spend_amount_usd,
    p.category_name
from fact_sales f
join dim_product p on f.dim_productid = p.dim_productid
where f.spend_amount_usd > 0;

--4.busiest days of the week/month
select
    d.day_of_week_name,
    d.month,
    sum(f.spend_amount_usd) as total_revenue
from fact_sales f
join dim_date d on f.dim_dateid = d.dim_dateid
group by d.day_of_week_name, d.month
order by sum(f.spend_amount_usd) desc;

--5.avg transaction value
select 
    round(avg(spend_amount_usd), 2) as avg_basket_value
from fact_sales;

--6.revenue by merchant channel
select 
    m.merchant_channel, 
    sum(f.spend_amount_usd) as total_revenue
from fact_sales f
join dim_merchant m on f.dim_merchantid = m.dim_merchantid
group by 1
order by 2 desc;
